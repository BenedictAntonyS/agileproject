"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,s,c,o){return new(c=c||Promise)(function(a,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function n(e){try{l(o.throw(e))}catch(e){t(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof c?t:new c(function(e){e(t)})).then(r,n)}l((o=o.apply(e,s||[])).next())})},__generator=this&&this.__generator||function(a,r){var n,l,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,l&&(s=2&t[0]?l.return:t[0]?l.throw||((s=l.return)&&s.call(l),0):l.next)&&!(s=s.call(l,t[1])).done)return s;switch(l=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,l=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){c.label=t[1];break}if(6===t[0]&&c.label<s[1]){c.label=s[1],s=t;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(t);break}s[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(a,c)}catch(e){t=[6,e],l=0}finally{n=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};exports.__esModule=!0;var react_1=require("react"),react_router_dom_1=require("react-router-dom"),axios_1=require("axios"),lucide_react_1=require("lucide-react"),UserContext_1=require("../context/UserContext"),LoginPage=function(){var e=UserContext_1.useUser(),t=e.isAuthenticated,c=e.userType,o=e.login,a=e.setUserType,r=(UserContext_1.useUser1().username,react_1.useState("login")),i=r[0],u=r[1],n=react_1.useState({email:"",password:"",name:""}),d=n[0],l=n[1],s=react_1.useState(!1),m=s[0],f=s[1],g=react_1.useState(""),_=g[0],p=g[1],b=react_router_dom_1.useNavigate();if(t)return react_1.default.createElement(react_router_dom_1.Navigate,{to:"admin"===c?"/admin":"/user"});function x(e){var t;l(__assign(__assign({},d),((t={})[e.target.name]=e.target.value,t)))}return react_1.default.createElement("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4"},react_1.default.createElement("div",{className:"max-w-4xl w-full bg-white rounded-2xl shadow-xl flex flex-col md:flex-row overflow-hidden"},react_1.default.createElement("div",{className:"md:w-1/2 bg-indigo-600 p-8 text-white flex flex-col justify-center"},react_1.default.createElement("h1",{className:"text-4xl font-bold mb-6"},"Campus Connector"),react_1.default.createElement("p",{className:"text-lg mb-6"},"Connect, Network, and Participate in Campus Events"),react_1.default.createElement("div",{className:"space-y-4"},react_1.default.createElement("div",{className:"flex items-center"},react_1.default.createElement(lucide_react_1.Users,{className:"w-6 h-6 mr-3"}),react_1.default.createElement("span",null,"Connect with fellow students")),react_1.default.createElement("div",{className:"flex items-center"},react_1.default.createElement(lucide_react_1.ShieldCheck,{className:"w-6 h-6 mr-3"}),react_1.default.createElement("span",null,"Secure event management")))),react_1.default.createElement("div",{className:"md:w-1/2 p-8"},"login"===i&&react_1.default.createElement("div",{className:"flex justify-center mb-6"},react_1.default.createElement("div",{className:"bg-gray-100 p-1 rounded-lg inline-flex"},react_1.default.createElement("button",{className:"px-4 py-2 rounded-md "+("user"===c?"bg-white shadow-sm text-indigo-600":"text-gray-500"),onClick:function(){return a("user")}},"User"),react_1.default.createElement("button",{className:"px-4 py-2 rounded-md "+("admin"===c?"bg-white shadow-sm text-indigo-600":"text-gray-500"),onClick:function(){return a("admin")}},"Admin"))),react_1.default.createElement("h2",{className:"text-2xl font-bold text-center mb-6"},"login"===i?"admin"===c?"Admin Login":"User Login":"Create Account"),_&&react_1.default.createElement("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg"},_),react_1.default.createElement("form",{onSubmit:function(s){return __awaiter(void 0,void 0,void 0,function(){var t,a,r,n,l;return __generator(this,function(e){switch(e.label){case 0:s.preventDefault(),f(!0),p(""),e.label=1;case 1:return e.trys.push([1,6,7,8]),"login"!==i?[3,3]:[4,axios_1.default.post("http://localhost:5013/api/login",{email:d.email,password:d.password,userType:c})];case 2:return 200===(a=e.sent()).status&&(t=a.data.user,o(t),b("admin"===t.userType?"/admin":"/user")),[3,5];case 3:return[4,axios_1.default.post("http://localhost:5013/api/register",{name:d.name,email:d.email,password:d.password})];case 4:201===(a=e.sent()).status&&(alert("Registration Successful! Please log in."),u("login")),e.label=5;case 5:return[3,8];case 6:return r=e.sent(),p((null===(l=null===(n=r.response)||void 0===n?void 0:n.data)||void 0===l?void 0:l.message)||"An error occurred"),[3,8];case 7:return f(!1),[7];case 8:return[2]}})})},className:"space-y-4"},"register"===i&&react_1.default.createElement("div",null,react_1.default.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Full Name"),react_1.default.createElement("input",{type:"text",name:"name",value:d.name,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})),react_1.default.createElement("div",null,react_1.default.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email Address"),react_1.default.createElement("input",{type:"email",name:"email",value:d.email,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})),react_1.default.createElement("div",null,react_1.default.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Password"),react_1.default.createElement("input",{type:"password",name:"password",value:d.password,onChange:x,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})),react_1.default.createElement("button",{type:"submit",disabled:m,className:"w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center space-x-2 "+(m?"opacity-70 cursor-not-allowed":"")},m?"Processing...":"login"===i?react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(lucide_react_1.LogIn,{className:"w-5 h-5"}),react_1.default.createElement("span",null,"Login")):react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(lucide_react_1.UserPlus,{className:"w-5 h-5"}),react_1.default.createElement("span",null,"Register"))),"user"===c&&react_1.default.createElement("p",{className:"text-center text-sm text-gray-600"},"login"===i?"Don't have an account? ":"Already have an account? ",react_1.default.createElement("button",{type:"button",onClick:function(){return u("login"===i?"register":"login")},className:"text-indigo-600 hover:text-indigo-800 font-medium"},"login"===i?"Register here":"Login here"))))))};exports.default=LoginPage;